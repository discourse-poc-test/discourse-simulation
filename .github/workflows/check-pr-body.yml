name: Check PR Body
on:
  pull_request_target:
    types: [opened, reopened, edited]

jobs:
  sanitize:
    if: github.event.pull_request.user.login == 'test-bot'
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5
        with:
          ref: ${{ github.event.pull_request.head.sha }}
      
      - name: Vulnerable Execution
        run: |
          echo "========================================"
          echo "ğŸš¨ VULNERABILITY EXPLOITED!"
          echo "========================================"
          echo ""
          echo "ğŸ”“ pull_request_target event triggered"
          echo "ğŸ  Running in BASE repository context"
          echo "ğŸ”‘ GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN != '' }}"
          echo "ğŸ“¦ Repository: ${{ github.repository }}"
          echo ""
          echo "ğŸ’¥ IMPACT DEMONSTRATION:"
          echo "â€¢ Attacker's code from fork is executing"
          echo "â€¢ Full access to repository secrets"
          echo "â€¢ Can modify protected branches"
          echo "â€¢ Can inject malicious code"
          echo ""
          echo "ğŸ“Œ This simulates Discourse vulnerability"
          echo "========================================"
